// --- è«‹å°‡ window.renderSubmissions æ›¿æ›æˆé€™ä¸€æ®µ ---
        
        // 1. å…ˆå®šç¾©åˆªé™¤åŠŸèƒ½ (æ”¾åœ¨ render å¤–é¢æ¯”è¼ƒå®‰å…¨)
        window.deleteSubmission = async function(id) {
            if(!confirm("âš ï¸ ç¢ºå®šè¦æ°¸ä¹…åˆªé™¤é€™ä»½å­¸ç”Ÿçš„ä½œæ¥­å—ï¼Ÿåˆªé™¤å¾Œç„¡æ³•å¾©åŸå–”ï¼")) {
                return;
            }
            try {
                await deleteDoc(doc(db, 'artifacts', appId, 'public', 'data', 'student_summaries', id));
                alert("ğŸ—‘ï¸ ä½œæ¥­å·²åˆªé™¤");
            } catch(e) {
                console.error("åˆªé™¤å¤±æ•—:", e);
                alert("åˆªé™¤å¤±æ•—ï¼Œè«‹æª¢æŸ¥ Console éŒ¯èª¤è¨Šæ¯");
            }
        }

        // 2. æ¸²æŸ“è¡¨æ ¼çš„ä¸»ç¨‹å¼
        window.renderSubmissions = function() {
            const tbody = document.getElementById('submissions-body');
            const sort = document.getElementById('sort-select').value;
            tbody.innerHTML = '';
            
            // æ’åºè³‡æ–™
            const sorted = [...currentSubmissions].sort((a, b) => {
                if(sort === 'seat') return (parseInt(a.studentInfo.seatNumber)||999) - (parseInt(b.studentInfo.seatNumber)||999);
                return (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0);
            });
            document.getElementById('submission-count').innerText = sorted.length;

            // ç”¢ç”Ÿæ¯ä¸€åˆ—è³‡æ–™
            sorted.forEach(sub => {
                const date = sub.createdAt ? new Date(sub.createdAt.seconds * 1000).toLocaleDateString() : '-';
                const tr = document.createElement('tr');
                tr.className = "hover:bg-white transition-colors";
                
                // é€™è£¡çš„ ` ` (åå¼•è™Ÿ) éå¸¸é‡è¦ï¼Œä¸èƒ½å°‘ï¼
                tr.innerHTML = `
                    <td class="p-3 text-gray-500">${date}</td>
                    <td class="p-3 font-bold text-gray-800">${sub.studentInfo.name}</td>
                    <td class="p-3 text-gray-800">${sub.studentInfo.seatNumber}</td>
                    <td class="p-3 text-gray-800">${sub.stats.originalLength} / <span class="font-bold text-indigo-600">${sub.stats.summaryLength || sub.finalSummary.length}</span></td>
                    <td class="p-3 text-blue-700 font-bold bg-blue-50/30 border-l border-blue-50">${sub.stats.ratio}%</td>
                    <td class="p-3 text-red-700 font-bold bg-red-50/30 border-l border-red-50">${sub.stats.deletionFragments}</td>
                    <td class="p-3 text-2xl">${sub.checks.confidence === 'good' ? 'ğŸ˜„' : sub.checks.confidence === 'ok' ? 'ğŸ™‚' : 'ğŸ¤”'}</td>
                    <td class="p-3">
                        <button onclick="deleteSubmission('${sub.id}')" class="text-red-400 hover:text-red-600 hover:bg-red-50 p-2 rounded-full transition-colors" title="åˆªé™¤ä½œæ¥­">
                            <i data-lucide="trash-2" class="w-5 h-5"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
            // é‡æ–°è¼‰å…¥åœ–ç¤º
            lucide.createIcons();
        }
